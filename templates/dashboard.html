{% extends 'index.html' %}

{% block title %}Tableau de bord - RecoFlix{% endblock %}

{% block content %}
<div class="container my-5">
    <!-- Section de bienvenue -->
    <div class="p-5 text-center bg-light rounded-3 shadow-sm mb-5">
        <h1 class="display-4 fw-bold text-primary mb-3">Bienvenue sur RecoFlix, {{ username }} !</h1>
        <p class="lead text-muted">
            D√©couvrez des films qui correspondent parfaitement √† vos go√ªts. Pr√©parez-vous √† explorer votre prochaine obsession cin√©matographique.
        </p>
        <hr class="my-4">
        <p class="text-muted small">Votre compte : {{ user_email }}</p>
        <a href="{{ url_for('api_routes.logout') }}" class="btn btn-outline-danger btn-lg mt-3">
            <i class="bi bi-box-arrow-right"></i> Se d√©connecter
        </a>
    </div>

    <!-- Conteneur pour les messages dynamiques (JavaScript) -->
    <div id="dynamic-alert-container" class="mt-3"></div>

    <!-- Nouvelle Section : Film du Jour (maintenant unique) -->
    <h2 class="text-center text-primary mb-4">Film du Jour üé¨</h2>
    <div class="card mb-5 shadow-lg border-0">
        <div class="row g-0">
            <div class="col-md-4">
                <img src="{{ url_for('static', filename='css/images/voyage1.jpg') }}" class="img-fluid rounded-start h-100 object-fit-cover" alt="Affiche du Film du Jour">
            </div>
            <div class="col-md-8">
                <div class="card-body p-4">
                    <h3 class="card-title text-dark fw-bold">Le Voyage de Chihiro</h3>
                    <p class="card-text text-muted">Genre: Animation, Fantastique, Aventure</p>
                    <p class="card-text">
                        Chihiro, une jeune fille de 10 ans, d√©m√©nage avec ses parents. Sur la route, ils s'arr√™tent devant un myst√©rieux tunnel qui les m√®ne vers un monde peupl√© de dieux et d'esprits. Un chef-d'≈ìuvre de l'animation japonaise.
                    </p>
                    <div class="d-flex justify-content-between align-items-center mt-3">
                        <span class="badge bg-warning text-dark"><i class="bi bi-star-fill"></i> 9.0/10</span>
                        <button type="button" class="btn btn-primary view-details-btn"
                                data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                                data-title="Le Voyage de Chihiro"
                                data-genre="Animation, Fantastique, Aventure"
                                data-description="Chihiro, une jeune fille de 10 ans, d√©m√©nage avec ses parents. Sur la route, ils s'arr√™tent devant un myst√©rieux tunnel qui les m√®ne vers un monde peupl√© de dieux et d'esprits. Un chef-d'≈ìuvre de l'animation japonaise."
                                data-rating="9.0"
                                data-image="{{ url_for('static', filename='css/images/voyage1.jpg') }}"
                                data-video-url="https://www.youtube.com/embed/ByXuk9Qqxkk"> {# URL vid√©o d'int√©gration YouTube #}
                            Voir les d√©tails <i class="bi bi-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Section de recherche de films -->
    <div class="card shadow-sm mb-5">
        <div class="card-body p-4">
            <h2 class="card-title text-center text-secondary mb-4">Trouvez votre prochain film</h2>
            <form class="d-flex">
                <input class="form-control me-2 rounded-pill" type="search" placeholder="Entrez le nom d'un film que vous aimez..." aria-label="Rechercher">
                <button class="btn btn-primary rounded-pill" type="submit">Rechercher</button>
            </form>
            <p class="text-muted text-center mt-3 small">
                *La fonctionnalit√© de recherche et de recommandation sera bient√¥t disponible !
            </p>
        </div>
    </div>

    <!-- Nouvelle Section : Carrousel des Films les Plus Vus -->
    <h2 class="text-center text-primary mb-4">Films les Plus Vus <i class="bi bi-eye-fill"></i></h2>
    <div id="mostViewedCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
        <div class="carousel-inner">
            {# Premier slide #}
            <div class="carousel-item active">
                <div class="row row-cols-1 row-cols-md-5 g-4 justify-content-center">
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 1"
                             data-genre="Action, Aventure"
                             data-description="Un film d'action palpitant avec des sc√®nes spectaculaires et une histoire captivante."
                             data-rating="8.5"
                             data-image="{{ url_for('static', filename='css/images/film1.jpg') }}"
                             data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                            <img src="{{ url_for('static', filename='css/images/film1.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 1</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 2"
                             data-genre="Drame, Romance"
                             data-description="Une histoire d'amour √©mouvante et d√©chirante qui vous tiendra en haleine du d√©but √† la fin."
                             data-rating="7.9"
                             data-image="{{ url_for('static', filename='css/images/film2.jpg') }}"
                             data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                            <img src="{{ url_for('static', filename='css/images/film2.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 2</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 3"
                             data-genre="Science-fiction, Thriller"
                             data-description="Un thriller de science-fiction qui explore les limites de la technologie et de l'humanit√©."
                             data-rating="8.8"
                             data-image="{{ url_for('static', filename='css/images/film3.jpg') }}"
                             data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                            <img src="{{ url_for('static', filename='css/images/film3.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 3</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 4"
                             data-genre="Com√©die, Famille"
                             data-description="Une com√©die l√©g√®re et amusante parfaite pour toute la famille, pleine de rires et de moments tendres."
                             data-rating="7.2"
                             data-image="{{ url_for('static', filename='css/images/film4.jpg') }}"
                             data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                            <img src="{{ url_for('static', filename='css/images/film4.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 4</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 5"
                             data-genre="Action, Thriller"
                             data-description="Un film d'action intense avec des rebondissements inattendus et une performance d'acteur exceptionnelle."
                             data-rating="8.1"
                             data-image="{{ url_for('static', filename='css/images/film5.jpg') }}"
                             data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                            <img src="{{ url_for('static', filename='css/images/film5.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 5</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {# Deuxi√®me slide #}
            <div class="carousel-item">
                <div class="row row-cols-1 row-cols-md-5 g-4 justify-content-center">
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 6"
                             data-genre="Animation, Aventure"
                             data-description="Une aventure anim√©e pleine de magie et de personnages attachants, pour petits et grands."
                             data-rating="8.3"
                             data-image="{{ url_for('static', filename='css/images/vu film1.jpg') }}"
                             data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                            <img src="{{ url_for('static', filename='css/images/vu film1.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 6</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 7"
                             data-genre="Fantastique, Drame"
                             data-description="Un drame fantastique qui explore des th√®mes profonds avec une touche de surnaturel."
                             data-rating="7.5"
                             data-image="{{ url_for('static', filename='css/images/vu film2.jpg') }}"
                             data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                            <img src="{{ url_for('static', filename='css/images/vu film2.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 7</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 8"
                             data-genre="Com√©die, Musical"
                             data-description="Une com√©die musicale entra√Ænante avec des num√©ros de danse et des chansons m√©morables."
                             data-rating="7.8"
                             data-image="{{ url_for('static', filename='css/images/vu film3.jpg') }}"
                             data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                            <img src="{{ url_for('static', filename='css/images/vu film3.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 8</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 9"
                             data-genre="Horreur, Myst√®re"
                             data-description="Un film d'horreur psychologique qui vous tiendra en haleine jusqu'√† la derni√®re minute."
                             data-rating="6.9"
                             data-image="{{ url_for('static', filename='css/images/tendance1.jpg') }}"
                             data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                            <img src="{{ url_for('static', filename='css/images/tendance1.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 9</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 10"
                             data-genre="Action, Aventure"
                             data-description="Une aventure √©pique remplie d'action, de tr√©sors cach√©s et de paysages √† couper le souffle."
                             data-rating="8.0"
                             data-image="{{ url_for('static', filename='css/images/tendance2.jpg') }}"
                             data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                            <img src="{{ url_for('static', filename='css/images/tendance2.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 10</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#mostViewedCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#mostViewedCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>

    <!-- Section des recommandations -->
    <h2 class="text-center text-primary mb-4">Vos Recommandations Personnalis√©es</h2>
    <div class="row row-cols-1 row-cols-md-4 g-4 mb-5">
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Titre du Film Recommand√© 1"
                 data-genre="Action, Aventure"
                 data-description="Une br√®ve description du film et pourquoi il pourrait vous plaire."
                 data-rating="7.0"
                 data-image="{{ url_for('static', filename='css/images/film1.jpg') }}"
                 data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                <img src="{{ url_for('static', filename='css/images/film1.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                <div class="card-body">
                    <h5 class="card-title text-dark">Titre du Film Recommand√© 1</h5>
                    <p class="card-text text-muted small">Genre: Action, Aventure</p>
                    <p class="card-text">Une br√®ve description du film et pourquoi il pourrait vous plaire.</p>
                    <button type="button" class="btn btn-outline-secondary btn-sm view-details-btn"
                            data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                            data-title="Titre du Film Recommand√© 1"
                            data-genre="Action, Aventure"
                            data-description="Une br√®ve description du film et pourquoi il pourrait vous plaire."
                            data-rating="7.0"
                            data-image="{{ url_for('static', filename='css/images/film1.jpg') }}"
                            data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                        Voir les d√©tails
                    </button>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Titre du Film Recommand√© 2"
                 data-genre="Drame, Science-fiction"
                 data-description="Une autre description int√©ressante pour ce film recommand√©."
                 data-rating="7.5"
                 data-image="{{ url_for('static', filename='css/images/film2.jpg') }}"
                 data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                <img src="{{ url_for('static', filename='css/images/film2.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                <div class="card-body">
                    <h5 class="card-title text-dark">Titre du Film Recommand√© 2</h5>
                    <p class="card-text text-muted small">Genre: Drame, Science-fiction</p>
                    <p class="card-text">Une autre description int√©ressante pour ce film recommand√©.</p>
                    <button type="button" class="btn btn-outline-secondary btn-sm view-details-btn"
                            data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                            data-title="Titre du Film Recommand√© 2"
                            data-genre="Drame, Science-fiction"
                            data-description="Une autre description int√©ressante pour ce film recommand√©."
                            data-rating="7.5"
                            data-image="{{ url_for('static', filename='css/images/film2.jpg') }}"
                            data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                        Voir les d√©tails
                    </button>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Titre du Film Recommand√© 3"
                 data-genre="Com√©die, Romance"
                 data-description="D√©couvrez pourquoi ce film est un excellent choix pour vous."
                 data-rating="8.0"
                 data-image="{{ url_for('static', filename='css/images/film3.jpg') }}"
                 data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                <img src="{{ url_for('static', filename='css/images/film3.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                <div class="card-body">
                    <h5 class="card-title text-dark">Titre du Film Recommand√© 3</h5>
                    <p class="card-text text-muted small">Genre: Com√©die, Romance</p>
                    <p class="card-text">D√©couvrez pourquoi ce film est un excellent choix pour vous.</p>
                    <button type="button" class="btn btn-outline-secondary btn-sm view-details-btn"
                            data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                            data-title="Titre du Film Recommand√© 3"
                            data-genre="Com√©die, Romance"
                            data-description="D√©couvrez pourquoi ce film est un excellent choix pour vous."
                            data-rating="8.0"
                            data-image="{{ url_for('static', filename='css/images/film3.jpg') }}"
                            data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                        Voir les d√©tails
                    </button>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Titre du Film Recommand√© 4"
                 data-genre="Thriller, Myst√®re"
                 data-description="Un autre film pour compl√©ter la ligne."
                 data-rating="7.3"
                 data-image="{{ url_for('static', filename='css/images/film4.jpg') }}"
                 data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                <img src="{{ url_for('static', filename='css/images/film4.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                <div class="card-body">
                    <h5 class="card-title text-dark">Titre du Film Recommand√© 4</h5>
                    <p class="card-text text-muted small">Genre: Thriller, Myst√®re</p>
                    <p class="card-text">Un autre film pour compl√©ter la ligne.</p>
                    <button type="button" class="btn btn-outline-secondary btn-sm view-details-btn"
                            data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                            data-title="Titre du Film Recommand√© 4"
                            data-genre="Thriller, Myst√®re"
                            data-description="Un autre film pour compl√©ter la ligne."
                            data-rating="7.3"
                            data-image="{{ url_for('static', filename='css/images/film4.jpg') }}"
                            data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                        Voir les d√©tails
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Nouvelle Section : Cat√©gories Populaires -->
    <h2 class="text-center text-primary mb-4">Cat√©gories Populaires <i class="bi bi-tags-fill"></i></h2>
    <div class="d-flex flex-wrap justify-content-center gap-2 mb-5">
        <a href="#" class="btn btn-outline-secondary rounded-pill">Action</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Com√©die</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Drame</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Science-fiction</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Horreur</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Animation</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Thriller</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Romance</a>
    </div>

    <!-- Nouvelle Section : Acteurs/R√©alisateurs √† Suivre -->
    <h2 class="text-center text-primary mb-4">Acteurs & R√©alisateurs √† Suivre <i class="bi bi-person-badge-fill"></i></h2>
    <div class="row row-cols-1 row-cols-md-4 g-4 mb-5">
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <img src="{{ url_for('static', filename='css/images/ludi boeken.jpg') }}" class="rounded-circle mx-auto mb-3" style="width: 100px; height: 100px; object-fit: cover;" alt="Acteur 1">
                <h5 class="card-title">ludi boeken</h5>
                <p class="card-text text-muted small">Realisateur</p>
                <a href="#" class="btn btn-outline-info btn-sm">Voir profil</a>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <img src="{{ url_for('static', filename='css/images/Martin scorese.jpg') }}" class="rounded-circle mx-auto mb-3" style="width: 100px; height: 100px; object-fit: cover;" alt="R√©alisateur 1">
                <h5 class="card-title">Martin scorese</h5>
                <p class="card-text text-muted small">R√©alisateur</p>
                <a href="#" class="btn btn-outline-info btn-sm">Voir profil</a>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <img src="{{ url_for('static', filename='css/images/m1.jpg') }}" class="rounded-circle mx-auto mb-3" style="width: 100px; height: 100px; object-fit: cover;" alt="Acteur 2">
                <h5 class="card-title">steven spielberg</h5>
                <p class="card-text text-muted small">Realisateur</p>
                <a href="#" class="btn btn-outline-info btn-sm">Voir profil</a>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <img src="{{ url_for('static', filename='css/images/brad pitt.jpg') }}" class="rounded-circle mx-auto mb-3" style="width: 100px; height: 100px; object-fit: cover;" alt="R√©alisateur 2">
                <h5 class="card-title">Brad pitt </h5>
                <p class="card-text text-muted small">Acteur</p>
                <a href="#" class="btn btn-outline-info btn-sm">Voir profil</a>
            </div>
        </div>
    </div>

    <!-- Nouvelle Section : Statistiques Personnelles -->
    <h2 class="text-center text-primary mb-4">Vos Statistiques Personnelles <i class="bi bi-graph-up"></i></h2>
    <div class="row row-cols-1 row-cols-md-3 g-4 mb-5">
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3 bg-info text-white">
                <div class="card-body">
                    <i class="bi bi-camera-reels-fill display-4 mb-3"></i>
                    <h5 class="card-title">Films Vus</h5>
                    <p class="display-3 fw-bold">125</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3 bg-success text-white">
                <div class="card-body">
                    <i class="bi bi-heart-fill display-4 mb-3"></i>
                    <h5 class="card-title">Films Aim√©s</h5>
                    <p class="display-3 fw-bold">87</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3 bg-warning text-dark">
                <div class="card-body">
                    <i class="bi bi-clock-fill display-4 mb-3"></i>
                    <h5 class="card-title">Heures Pass√©es</h5>
                    <p class="display-3 fw-bold">250</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Nouvelle Section : Recommandation Sp√©ciale -->
    <div class="p-5 text-center bg-dark text-white rounded-3 shadow-lg mb-5">
        <h2 class="display-5 fw-bold mb-3">Envie d'une Recommandation Sp√©ciale ?</h2>
        <p class="lead">
            Laissez notre IA vous surprendre avec un film que vous n'auriez jamais d√©couvert seul.
        </p>
        <button class="btn btn-light btn-lg mt-3">Obtenir une Recommandation Unique <i class="bi bi-magic"></i></button>
    </div>

    <!-- Section Liens Rapides (existante, d√©plac√©e) -->
    <h2 class="text-center text-primary mb-4">Acc√®s Rapide</h2>
    <div class="row row-cols-1 row-cols-md-3 g-4 mb-5">
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <div class="card-body">
                    <i class="bi bi-film text-secondary display-4 mb-3"></i>
                    <h5 class="card-title">Explorer les Genres</h5>
                    <p class="card-text text-muted small">Trouvez des films par cat√©gorie.</p>
                    <a href="#" class="btn btn-outline-primary mt-2">Go !</a>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <div class="card-body">
                    <i class="bi bi-star-fill text-warning display-4 mb-3"></i>
                    <h5 class="card-title">Mes Favoris</h5>
                    <p class="card-text text-muted small">Acc√©dez √† votre liste de films pr√©f√©r√©s.</p>
                    <a href="#" class="btn btn-outline-primary mt-2">Go !</a>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <div class="card-body">
                    <i class="bi bi-person-circle text-info display-4 mb-3"></i>
                    <h5 class="card-title">Mon Profil</h5>
                    <p class="card-text text-muted small">G√©rez vos informations de compte.</p>
                    <a href="#" class="btn btn-outline-primary mt-2">Go !</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Section Films R√©cemment Vus (existante) -->
    <h2 class="text-center text-primary mb-4">R√©cemment Vus</h2>
    <div class="row row-cols-1 row-cols-md-5 g-4 mb-5">
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Vaiana 2"
                 data-genre="Animation, Aventure"
                 data-description="Une suite captivante avec de nouveaux d√©fis et des personnages inoubliables."
                 data-rating="7.8"
                 data-image="{{ url_for('static', filename='css/images/vu film1.jpg') }}"
                 data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                <img src="{{ url_for('static', filename='css/images/vu film1.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film vu">
                <div class="card-body p-2 text-center">
                    <h6 class="card-title text-dark mb-0">Vaiana 2</h6>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Le Roi Lion"
                 data-genre="Animation, Drame"
                 data-description="Le Roi Lion est un classique intemporel de Disney. Suivez l'histoire de Simba."
                 data-rating="9.0"
                 data-image="{{ url_for('static', filename='css/images/le roi lion.jpg') }}"
                 data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                <img src="{{ url_for('static', filename='css/images/le roi lion.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film vu">
                <div class="card-body p-2 text-center">
                    <h6 class="card-title text-dark mb-0">Le Roi Lion</h6>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Interstellar"
                 data-genre="Science-fiction, Drame"
                 data-description="Un groupe d'explorateurs interstellaires utilise un trou de ver pour √©chapper √† un futur o√π la Terre est mourante."
                 data-rating="8.6"
                 data-image="{{ url_for('static', filename='css/images/tendance3.jpg') }}"
                 data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                <img src="{{ url_for('static', filename='css/images/tendance3.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film vu">
                <div class="card-body p-2 text-center">
                    <h6 class="card-title text-dark mb-0">Interstellar</h6>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Inception"
                 data-genre="Science-fiction, Action"
                 data-description="Un voleur qui d√©robe des secrets d'entreprise en utilisant la technologie de partage de r√™ves est charg√© d'une mission inverse."
                 data-rating="8.8"
                 data-image="{{ url_for('static', filename='css/images/inception.jpg') }}"
                 data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                <img src="{{ url_for('static', filename='css/images/inception.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film vu">
                <div class="card-body p-2 text-center">
                    <h6 class="card-title text-dark mb-0">Inception</h6>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="La La Land"
                 data-genre="Musical, Romance, Drame"
                 data-description="Un musicien de jazz et une actrice en herbe tombent amoureux √† Los Angeles."
                 data-rating="7.9"
                 data-image="{{ url_for('static', filename='css/images/La la land.jpg') }}"
                 data-video-url="https://www.youtube.com/embed/dQw4w9WgXcQ"> {# URL vid√©o d'int√©gration YouTube #}
                <img src="{{ url_for('static', filename='css/images/La la land.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film vu">
                <div class="card-body p-2 text-center">
                    <h6 class="card-title text-dark mb-0">La La Land</h6>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal pour les d√©tails du film -->
<div class="modal fade" id="filmDetailsModal" tabindex="-1" aria-labelledby="filmDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="filmDetailsModalLabel">D√©tails du Film</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-5">
                        <img src="" class="img-fluid rounded mb-3" id="modalFilmImage" alt="Affiche du film">
                        <p class="text-center mb-0">
                            <span class="badge bg-warning text-dark fs-5"><i class="bi bi-star-fill"></i> <span id="modalFilmRating"></span>/10</span>
                        </p>
                    </div>
                    <div class="col-md-7">
                        <h3 class="text-primary" id="modalFilmTitle"></h3>
                        <p class="text-muted" id="modalFilmGenre"></p>
                        <hr>
                        <p id="modalFilmDescription"></p>
                        <h6 class="mt-4">Bande-annonce:</h6>
                        <div class="ratio ratio-16x9">
                            <iframe id="modalFilmVideo" src="" title="Bande-annonce" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                <button type="button" class="btn btn-primary" id="addToListBtn"><i class="bi bi-heart-fill"></i> Ajouter aux favoris</button>
                <button type="button" class="btn btn-success" id="watchNowBtn"><i class="bi bi-play-circle-fill"></i> Regarder maintenant</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
{{ super() }}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const filmDetailsModal = document.getElementById('filmDetailsModal');
        const watchNowBtn = document.getElementById('watchNowBtn');
        const addToListBtn = document.getElementById('addToListBtn'); // R√©cup√©rer le bouton "Ajouter aux favoris"

        let currentFilmData = {}; // Stocker les donn√©es du film actuellement affich√© dans la modale

        // √âcouteur d'√©v√©nement lorsque la modale de d√©tails du film s'ouvre
        filmDetailsModal.addEventListener('show.bs.modal', function (event) {
            // Le bouton qui a d√©clench√© l'ouverture de la modale
            const button = event.relatedTarget;

            // Extrait les informations du film √† partir des attributs 'data-*' du bouton
            currentFilmData = { 
                title: button.getAttribute('data-title'),
                genre: button.getAttribute('data-genre'),
                description: button.getAttribute('data-description'),
                rating: parseFloat(button.getAttribute('data-rating')), // Convertir en nombre
                image: button.getAttribute('data-image'),
                video_url: button.getAttribute('data-video-url')
            };

            // Met √† jour le contenu de la modale avec les informations du film
            const modalTitle = filmDetailsModal.querySelector('#modalFilmTitle');
            const modalGenre = filmDetailsModal.querySelector('#modalFilmGenre');
            const modalDescription = filmDetailsModal.querySelector('#modalFilmDescription');
            const modalRating = filmDetailsModal.querySelector('#modalFilmRating');
            const modalImage = filmDetailsModal.querySelector('#modalFilmImage');
            const modalVideo = filmDetailsModal.querySelector('#modalFilmVideo');

            modalTitle.textContent = currentFilmData.title;
            modalGenre.textContent = 'Genre: ' + currentFilmData.genre;
            modalDescription.textContent = currentFilmData.description;
            modalRating.textContent = currentFilmData.rating;
            // Utilise url_for pour g√©n√©rer le chemin correct vers l'image statique
            modalImage.src = "{{ url_for('static', filename='') }}" + currentFilmData.image; 

            // D√©finit l'URL de la vid√©o. Assurez-vous que c'est une URL d'int√©gration.
            // Le JavaScript tente de convertir les URL 'watch?v=' en 'embed/'
            if (currentFilmData.video_url) {
                const embedUrl = currentFilmData.video_url.replace("watch?v=", "embed/");
                modalVideo.src = embedUrl;
            } else {
                modalVideo.src = ""; // Efface la vid√©o si aucune URL n'est fournie
            }
        });

        // Efface l'URL de la vid√©o lorsque la modale est ferm√©e pour arr√™ter la lecture
        filmDetailsModal.addEventListener('hidden.bs.modal', function (event) {
            const modalVideo = filmDetailsModal.querySelector('#modalFilmVideo');
            modalVideo.src = "";
            currentFilmData = {}; // R√©initialise les donn√©es du film
        });

        // G√©rer le clic sur le bouton "Regarder maintenant"
        watchNowBtn.addEventListener('click', async function() {
            if (!currentFilmData.title) {
                displayAlert('Impossible de lancer le film : donn√©es manquantes.', 'danger');
                return;
            }

            try {
                // Envoie une requ√™te POST √† la route Flask /watch_film
                const response = await fetch("{{ url_for('api_routes.watch_film') }}", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ title: currentFilmData.title }) // N'envoyez que le titre pour marquer comme vu
                });

                const result = await response.json();

                if (response.ok) {
                    displayAlert(result.message, 'success');
                    // Optionnel: Vous pouvez ouvrir la vid√©o dans un nouvel onglet
                    // if (result.video_url) {
                    //     window.open(result.video_url, '_blank');
                    // }
                } else {
                    displayAlert(result.message, 'danger');
                }
            } catch (error) {
                console.error('Erreur lors de l\'appel √† watch_film:', error);
                displayAlert('Une erreur r√©seau est survenue lors du lancement du film.', 'danger');
            }
        });

        // G√©rer le clic sur le bouton "Ajouter aux favoris"
        addToListBtn.addEventListener('click', async function() {
            if (!currentFilmData.title) {
                displayAlert('Impossible d\'ajouter le film : donn√©es manquantes.', 'danger');
                return;
            }

            try {
                // Envoie une requ√™te POST √† la route Flask /add_to_list
                const response = await fetch("{{ url_for('api_routes.add_to_list') }}", {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(currentFilmData) // Envoyer toutes les donn√©es du film
                });

                const result = await response.json();

                if (response.ok) {
                    displayAlert(result.message, result.status); // Utilise le statut retourn√© par le backend (success/info)
                } else {
                    displayAlert(result.message, 'danger');
                }
            } catch (error) {
                console.error('Erreur lors de l\'appel √† add_to_list:', error);
                displayAlert('Une erreur r√©seau est survenue lors de l\'ajout √† la liste.', 'danger');
            }
        });


        // Fonction utilitaire pour afficher les alertes dynamiques en haut de la page
        function displayAlert(message, category) {
            const dynamicAlertContainer = document.getElementById('dynamic-alert-container');
            if (dynamicAlertContainer) {
                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${category} alert-dismissible fade show`;
                alertDiv.setAttribute('role', 'alert');
                alertDiv.innerHTML = `
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                `;
                dynamicAlertContainer.appendChild(alertDiv);
                // Supprime l'alerte automatiquement apr√®s 5 secondes
                setTimeout(() => {
                    alertDiv.remove();
                }, 5000);
            }
        }

        // G√®re les messages flash de Flask qui pourraient √™tre pass√©s via l'URL
        const urlParams = new URLSearchParams(window.location.search);
        const message = urlParams.get('message');
        const category = urlParams.get('category');
        if (message && category) {
            displayAlert(message, category);
        }
    });
</script>
{% endblock %}
