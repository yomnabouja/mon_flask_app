{% extends 'index.html' %}

{% block title %}Tableau de bord - RecoFlix{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="p-5 text-center bg-light rounded-3 shadow-sm mb-5">
        <h1 class="display-4 fw-bold text-primary mb-3">Bienvenue sur RecoFlix, {{ username }} !</h1>
        <p class="lead text-muted">
            D√©couvrez des films qui correspondent parfaitement √† vos go√ªts. Pr√©parez-vous √† explorer votre prochaine obsession cin√©matographique.
        </p>
        <hr class="my-4">
        <p class="text-muted small">Votre compte : {{ user_email }}</p>
        <a href="{{ url_for('api_routes.logout') }}" class="btn btn-outline-danger btn-lg mt-3">
            <i class="bi bi-box-arrow-right"></i> Se d√©connecter
        </a>
    </div>

    <div id="dynamic-alert-container" class="mt-3"></div>

    <h2 class="text-center text-primary mb-4">Film du Jour üé¨</h2>
    <div class="card mb-5 shadow-lg border-0">
        <div class="row g-0">
            <div class="col-md-4">
                <img src="{{ url_for('static', filename='css/images/voyage1.jpg') }}" class="img-fluid rounded-start h-100 object-fit-cover" alt="Affiche du Film du Jour">
            </div>
            <div class="col-md-8">
                <div class="card-body p-4">
                    <h3 class="card-title text-dark fw-bold">Le Voyage de Chihiro</h3>
                    <p class="card-text text-muted">Genre: Animation, Fantastique, Aventure</p>
                    <p class="card-text">
                        Chihiro, une jeune fille de 10 ans, d√©m√©nage avec ses parents. Sur la route, ils s'arr√™tent devant un myst√©rieux tunnel qui les m√®ne vers un monde peupl√© de dieux et d'esprits. Un chef-d'≈ìuvre de l'animation japonaise.
                    </p>
                    <div class="d-flex justify-content-between align-items-center mt-3">
                        <span class="badge bg-warning text-dark"><i class="bi bi-star-fill"></i> 9.0/10</span>
                        <button type="button" class="btn btn-primary view-details-btn"
                                data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                                data-title="Le Voyage de Chihiro"
                                data-genre="Animation, Fantastique, Aventure"
                                data-description="Chihiro, une jeune fille de 10 ans, d√©m√©nage avec ses parents. Sur la route, ils s'arr√™tent devant un myst√©rieux tunnel qui les m√®ne vers un monde peupl√© de dieux et d'esprits. Un chef-d'≈ìuvre de l'animation japonaise."
                                data-rating="9.0"
                                data-image="{{ url_for('static', filename='css/images/voyage1.jpg') }}">
                            Voir les d√©tails <i class="bi bi-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow-sm mb-5">
        <div class="card-body p-4">
            <h2 class="card-title text-center text-secondary mb-4">Trouvez votre prochain film</h2>
            <form class="d-flex">
                <input class="form-control me-2 rounded-pill" type="search" placeholder="Entrez le nom d'un film que vous aimez..." aria-label="Rechercher">
                <button class="btn btn-primary rounded-pill" type="submit">Rechercher</button>
            </form>
            <p class="text-muted text-center mt-3 small">
                *La fonctionnalit√© de recherche et de recommandation sera bient√¥t disponible !
            </p>
        </div>
    </div>

    <h2 class="text-center text-primary mb-4">Films les Plus Vus <i class="bi bi-eye-fill"></i></h2>
    <div id="mostViewedCarousel" class="carousel slide mb-5" data-bs-ride="carousel">
        <div class="carousel-inner">
            {# Premier slide #}
            <div class="carousel-item active">
                <div class="row row-cols-1 row-cols-md-5 g-4 justify-content-center">
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 1"
                             data-genre="Action, Aventure"
                             data-description="Un film d'action palpitant avec des sc√®nes spectaculaires et une histoire captivante."
                             data-rating="8.5"
                             data-image="{{ url_for('static', filename='css/images/film1.jpg') }}">
                            <img src="{{ url_for('static', filename='css/images/film1.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 1</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 2"
                             data-genre="Drame, Romance"
                             data-description="Une histoire d'amour √©mouvante et d√©chirante qui vous tiendra en haleine du d√©but √† la fin."
                             data-rating="7.9"
                             data-image="{{ url_for('static', filename='css/images/film2.jpg') }}">
                            <img src="{{ url_for('static', filename='css/images/film2.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 2</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 3"
                             data-genre="Science-fiction, Thriller"
                             data-description="Un thriller de science-fiction qui explore les limites de la technologie et de l'humanit√©."
                             data-rating="8.8"
                             data-image="{{ url_for('static', filename='css/images/film3.jpg') }}">
                            <img src="{{ url_for('static', filename='css/images/film3.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 3</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 4"
                             data-genre="Com√©die, Famille"
                             data-description="Une com√©die l√©g√®re et amusante parfaite pour toute la famille, pleine de rires et de moments tendres."
                             data-rating="7.2"
                             data-image="{{ url_for('static', filename='css/images/film4.jpg') }}">
                            <img src="{{ url_for('static', filename='css/images/film4.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 4</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 5"
                             data-genre="Action, Thriller"
                             data-description="Un film d'action intense avec des rebondissements inattendus et une performance d'acteur exceptionnelle."
                             data-rating="8.1"
                             data-image="{{ url_for('static', filename='css/images/film5.jpg') }}">
                            <img src="{{ url_for('static', filename='css/images/film5.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 5</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {# Deuxi√®me slide #}
            <div class="carousel-item">
                <div class="row row-cols-1 row-cols-md-5 g-4 justify-content-center">
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 6"
                             data-genre="Animation, Aventure"
                             data-description="Une aventure anim√©e pleine de magie et de personnages attachants, pour petits et grands."
                             data-rating="8.3"
                             data-image="{{ url_for('static', filename='css/images/vu film1.jpg') }}">
                            <img src="{{ url_for('static', filename='css/images/vu film1.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 6</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 7"
                             data-genre="Fantastique, Drame"
                             data-description="Un drame fantastique qui explore des th√®mes profonds avec une touche de surnaturel."
                             data-rating="7.5"
                             data-image="{{ url_for('static', filename='css/images/vu film2.jpg') }}">
                            <img src="{{ url_for('static', filename='css/images/vu film2.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 7</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 8"
                             data-genre="Com√©die, Musical"
                             data-description="Une com√©die musicale entra√Ænante avec des num√©ros de danse et des chansons m√©morables."
                             data-rating="7.8"
                             data-image="{{ url_for('static', filename='css/images/vu film3.jpg') }}">
                            <img src="{{ url_for('static', filename='css/images/vu film3.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 8</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 9"
                             data-genre="Horreur, Myst√®re"
                             data-description="Un film d'horreur psychologique qui vous tiendra en haleine jusqu'√† la derni√®re minute."
                             data-rating="6.9"
                             data-image="{{ url_for('static', filename='css/images/tendance1.jpg') }}">
                            <img src="{{ url_for('static', filename='css/images/tendance1.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 9</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 shadow-sm border-0 film-card"
                             data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                             data-title="Film Populaire 10"
                             data-genre="Action, Aventure"
                             data-description="Une aventure √©pique remplie d'action, de tr√©sors cach√©s et de paysages √† couper le souffle."
                             data-rating="8.0"
                             data-image="{{ url_for('static', filename='css/images/tendance2.jpg') }}">
                            <img src="{{ url_for('static', filename='css/images/tendance2.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                            <div class="card-body p-2 text-center">
                                <h6 class="card-title text-dark mb-0">Film Populaire 10</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#mostViewedCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#mostViewedCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>

    <h2 class="text-center text-primary mb-4">Vos Recommandations Personnalis√©es</h2>
    <div class="row row-cols-1 row-cols-md-4 g-4 mb-5">
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Titre du Film Recommand√© 1"
                 data-genre="Action, Aventure"
                 data-description="Une br√®ve description du film et pourquoi il pourrait vous plaire."
                 data-rating="7.0"
                 data-image="{{ url_for('static', filename='css/images/film1.jpg') }}">
                <img src="{{ url_for('static', filename='css/images/film1.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                <div class="card-body">
                    <h5 class="card-title text-dark">Titre du Film Recommand√© 1</h5>
                    <p class="card-text text-muted small">Genre: Action, Aventure</p>
                    <p class="card-text">Une br√®ve description du film et pourquoi il pourrait vous plaire.</p>
                    <button type="button" class="btn btn-outline-secondary btn-sm view-details-btn"
                            data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                            data-title="Titre du Film Recommand√© 1"
                            data-genre="Action, Aventure"
                            data-description="Une br√®ve description du film et pourquoi il pourrait vous plaire."
                            data-rating="7.0"
                            data-image="{{ url_for('static', filename='css/images/film1.jpg') }}">
                        Voir les d√©tails
                    </button>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Titre du Film Recommand√© 2"
                 data-genre="Drame, Science-fiction"
                 data-description="Une autre description int√©ressante pour ce film recommand√©."
                 data-rating="7.5"
                 data-image="{{ url_for('static', filename='css/images/film2.jpg') }}">
                <img src="{{ url_for('static', filename='css/images/film2.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                <div class="card-body">
                    <h5 class="card-title text-dark">Titre du Film Recommand√© 2</h5>
                    <p class="card-text text-muted small">Genre: Drame, Science-fiction</p>
                    <p class="card-text">Une autre description int√©ressante pour ce film recommand√©.</p>
                    <button type="button" class="btn btn-outline-secondary btn-sm view-details-btn"
                            data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                            data-title="Titre du Film Recommand√© 2"
                            data-genre="Drame, Science-fiction"
                            data-description="Une autre description int√©ressante pour ce film recommand√©."
                            data-rating="7.5"
                            data-image="{{ url_for('static', filename='css/images/film2.jpg') }}">
                        Voir les d√©tails
                    </button>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Titre du Film Recommand√© 3"
                 data-genre="Com√©die, Romance"
                 data-description="D√©couvrez pourquoi ce film est un excellent choix pour vous."
                 data-rating="8.0"
                 data-image="{{ url_for('static', filename='css/images/film3.jpg') }}">
                <img src="{{ url_for('static', filename='css/images/film3.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                <div class="card-body">
                    <h5 class="card-title text-dark">Titre du Film Recommand√© 3</h5>
                    <p class="card-text text-muted small">Genre: Com√©die, Romance</p>
                    <p class="card-text">D√©couvrez pourquoi ce film est un excellent choix pour vous.</p>
                    <button type="button" class="btn btn-outline-secondary btn-sm view-details-btn"
                            data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                            data-title="Titre du Film Recommand√© 3"
                            data-genre="Com√©die, Romance"
                            data-description="D√©couvrez pourquoi ce film est un excellent choix pour vous."
                            data-rating="8.0"
                            data-image="{{ url_for('static', filename='css/images/film3.jpg') }}">
                        Voir les d√©tails
                    </button>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Titre du Film Recommand√© 4"
                 data-genre="Thriller, Myst√®re"
                 data-description="Un autre film pour compl√©ter la ligne."
                 data-rating="7.3"
                 data-image="{{ url_for('static', filename='css/images/film4.jpg') }}">
                <img src="{{ url_for('static', filename='css/images/film4.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film">
                <div class="card-body">
                    <h5 class="card-title text-dark">Titre du Film Recommand√© 4</h5>
                    <p class="card-text text-muted small">Genre: Thriller, Myst√®re</p>
                    <p class="card-text">Un autre film pour compl√©ter la ligne.</p>
                    <button type="button" class="btn btn-outline-secondary btn-sm view-details-btn"
                            data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                            data-title="Titre du Film Recommand√© 4"
                            data-genre="Thriller, Myst√®re"
                            data-description="Un autre film pour compl√©ter la ligne."
                            data-rating="7.3"
                            data-image="{{ url_for('static', filename='css/images/film4.jpg') }}">
                        Voir les d√©tails
                    </button>
                </div>
            </div>
        </div>
    </div>

    <h2 class="text-center text-primary mb-4">Cat√©gories Populaires <i class="bi bi-tags-fill"></i></h2>
    <div class="d-flex flex-wrap justify-content-center gap-2 mb-5">
        <a href="#" class="btn btn-outline-secondary rounded-pill">Action</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Com√©die</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Drame</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Science-fiction</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Horreur</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Animation</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Thriller</a>
        <a href="#" class="btn btn-outline-secondary rounded-pill">Romance</a>
    </div>

    <h2 class="text-center text-primary mb-4">Acteurs & R√©alisateurs √† Suivre <i class="bi bi-person-badge-fill"></i></h2>
    <div class="row row-cols-1 row-cols-md-4 g-4 mb-5">
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <img src="{{ url_for('static', filename='css/images/ludi boeken.jpg') }}" class="rounded-circle mx-auto mb-3" style="width: 100px; height: 100px; object-fit: cover;" alt="Acteur 1">
                <h5 class="card-title">ludi boeken</h5>
                <p class="card-text text-muted small">Realisateur</p>
                <a href="#" class="btn btn-outline-info btn-sm">Voir profil</a>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <img src="{{ url_for('static', filename='css/images/Martin scorese.jpg') }}" class="rounded-circle mx-auto mb-3" style="width: 100px; height: 100px; object-fit: cover;" alt="R√©alisateur 1">
                <h5 class="card-title">Martin scorese</h5>
                <p class="card-text text-muted small">R√©alisateur</p>
                <a href="#" class="btn btn-outline-info btn-sm">Voir profil</a>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <img src="{{ url_for('static', filename='css/images/m1.jpg') }}" class="rounded-circle mx-auto mb-3" style="width: 100px; height: 100px; object-fit: cover;" alt="Acteur 2">
                <h5 class="card-title">steven spielberg</h5>
                <p class="card-text text-muted small">Realisateur</p>
                <a href="#" class="btn btn-outline-info btn-sm">Voir profil</a>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <img src="{{ url_for('static', filename='css/images/brad pitt.jpg') }}" class="rounded-circle mx-auto mb-3" style="width: 100px; height: 100px; object-fit: cover;" alt="R√©alisateur 2">
                <h5 class="card-title">Brad pitt </h5>
                <p class="card-text text-muted small">Acteur</p>
                <a href="#" class="btn btn-outline-info btn-sm">Voir profil</a>
            </div>
        </div>
    </div>

    <h2 class="text-center text-primary mb-4">Vos Statistiques Personnelles <i class="bi bi-graph-up"></i></h2>
    <div class="row row-cols-1 row-cols-md-3 g-4 mb-5">
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3 bg-info text-white">
                <div class="card-body">
                    <i class="bi bi-camera-reels-fill display-4 mb-3"></i>
                    <h5 class="card-title">Films Vus</h5>
                    <p class="display-3 fw-bold">125</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3 bg-success text-white">
                <div class="card-body">
                    <i class="bi bi-heart-fill display-4 mb-3"></i>
                    <h5 class="card-title">Films Aim√©s</h5>
                    <p class="display-3 fw-bold">87</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3 bg-warning text-dark">
                <div class="card-body">
                    <i class="bi bi-clock-fill display-4 mb-3"></i>
                    <h5 class="card-title">Heures Pass√©es</h5>
                    <p class="display-3 fw-bold">250</p>
                </div>
            </div>
        </div>
    </div>

    <div class="p-5 text-center bg-dark text-white rounded-3 shadow-lg mb-5">
        <h2 class="display-5 fw-bold mb-3">Envie d'une Recommandation Sp√©ciale ?</h2>
        <p class="lead">
            Laissez notre IA vous surprendre avec un film que vous n'auriez jamais d√©couvert seul.
        </p>
        <button class="btn btn-light btn-lg mt-3">Obtenir une Recommandation Unique <i class="bi bi-magic"></i></button>
    </div>

    <h2 class="text-center text-primary mb-4">Acc√®s Rapide</h2>
    <div class="row row-cols-1 row-cols-md-3 g-4 mb-5">
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <div class="card-body">
                    <i class="bi bi-film text-secondary display-4 mb-3"></i>
                    <h5 class="card-title">Explorer les Genres</h5>
                    <p class="card-text text-muted small">Trouvez des films par cat√©gorie.</p>
                    <a href="#" class="btn btn-outline-primary mt-2">Go !</a>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <div class="card-body">
                    <i class="bi bi-star-fill text-warning display-4 mb-3"></i>
                    <h5 class="card-title">Mes Favoris</h5>
                    <p class="card-text text-muted small">Acc√©dez √† votre liste de films pr√©f√©r√©s.</p>
                    <a href="#" class="btn btn-outline-primary mt-2">Go !</a>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm text-center p-3">
                <div class="card-body">
                    <i class="bi bi-person-circle text-info display-4 mb-3"></i>
                    <h5 class="card-title">Mon Profil</h5>
                    <p class="card-text text-muted small">G√©rez vos informations de compte.</p>
                    <a href="#" class="btn btn-outline-primary mt-2">Go !</a>
                </div>
            </div>
        </div>
    </div>

    <h2 class="text-center text-primary mb-4">R√©cemment Vus</h2>
    <div class="row row-cols-1 row-cols-md-5 g-4 mb-5">
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Viaiana 2"
                 data-genre="Animation, Aventure"
                 data-description="Une suite captivante avec de nouveaux d√©fis et des personnages inoubliables."
                 data-rating="7.8"
                 data-image="{{ url_for('static', filename='css/images/vu film1.jpg') }}">
                <img src="{{ url_for('static', filename='css/images/vu film1.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film vu">
                <div class="card-body p-2 text-center">
                    <h6 class="card-title text-dark mb-0">Viaiana 2</h6>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Film r√©cemment vu 2"
                 data-genre="Documentaire"
                 data-description="Un documentaire fascinant sur la nature sauvage."
                 data-rating="8.2"
                 data-image="{{ url_for('static', filename='css/images/vu film2.jpg') }}">
                <img src="{{ url_for('static', filename='css/images/vu film2.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film vu">
                <div class="card-body p-2 text-center">
                    <h6 class="card-title text-dark mb-0">Film r√©cemment vu 2</h6>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Film r√©cemment vu 3"
                 data-genre="Com√©die"
                 data-description="Une com√©die l√©g√®re pour passer un bon moment."
                 data-rating="6.5"
                 data-image="{{ url_for('static', filename='css/images/vu film3.jpg') }}">
                <img src="{{ url_for('static', filename='css/images/vu film3.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film vu">
                <div class="card-body p-2 text-center">
                    <h6 class="card-title text-dark mb-0">Film r√©cemment vu 3</h6>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Film r√©cemment vu 4"
                 data-genre="Action"
                 data-description="Un film d'action rempli d'adr√©naline."
                 data-rating="7.9"
                 data-image="{{ url_for('static', filename='css/images/film4.jpg') }}">
                <img src="{{ url_for('static', filename='css/images/film4.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film vu">
                <div class="card-body p-2 text-center">
                    <h6 class="card-title text-dark mb-0">Film r√©cemment vu 4</h6>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 film-card"
                 data-bs-toggle="modal" data-bs-target="#filmDetailsModal"
                 data-title="Film r√©cemment vu 5"
                 data-genre="Horreur"
                 data-description="Un film effrayant pour les amateurs de frissons."
                 data-rating="5.8"
                 data-image="{{ url_for('static', filename='css/images/tendance1.jpg') }}">
                <img src="{{ url_for('static', filename='css/images/tendance1.jpg') }}" class="card-img-top rounded-top" alt="Affiche du film vu">
                <div class="card-body p-2 text-center">
                    <h6 class="card-title text-dark mb-0">Film r√©cemment vu 5</h6>
                </div>
            </div>
        </div>
    </div>

</div>

<div class="modal fade" id="filmDetailsModal" tabindex="-1" aria-labelledby="filmDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="filmDetailsModalLabel">D√©tails du Film</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-4">
                        <img id="modalFilmImage" src="" class="img-fluid rounded" alt="Affiche du film">
                    </div>
                    <div class="col-md-8">
                        <h3 id="modalFilmTitle" class="text-dark fw-bold"></h3>
                        <p class="text-muted"><strong class="text-primary">Genre:</strong> <span id="modalFilmGenre"></span></p>
                        <p id="modalFilmDescription"></p>
                        <div class="d-flex align-items-center mb-3">
                            <strong class="text-primary me-2">√âvaluation:</strong>
                            <span id="modalFilmRating" class="badge bg-warning text-dark fs-6"><i class="bi bi-star-fill"></i> </span>
                            <span class="ms-2 text-muted">/10</span>
                        </div>
                        <div class="d-grid gap-2">
                            <button class="btn btn-success btn-lg" id="playFilmBtn"><i class="bi bi-play-fill"></i> Regarder</button>
                            <button class="btn btn-outline-primary btn-lg" id="addToListBtn"><i class="bi bi-plus-circle-fill"></i> Ajouter √† ma liste</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
            </div>
        </div>
    </div>
</div>

<footer class="bg-dark text-white text-center py-4 mt-5">
    <div class="container">
        <p>&copy; 2025 RecoFlix. Tous droits r√©serv√©s.</p>
        <div class="social-icons">
            <a href="#" class="text-white mx-2"><i class="bi bi-facebook"></i></a>
            <a href="#" class="text-white mx-2"><i class="bi bi-twitter"></i></a>
            <a href="#" class="text-white mx-2"><i class="bi bi-instagram"></i></a>
        </div>
    </div>
</footer>
{% endblock %}

{% block scripts %}
{{ super() }} {# Conserve les scripts du template parent si vous en avez #}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const filmDetailsModal = document.getElementById('filmDetailsModal');
        const dynamicAlertContainer = document.getElementById('dynamic-alert-container');

        // IMPORTANT : V√©rifiez que Bootstrap JavaScript est charg√©.
        // Si cette ligne affiche une erreur dans la console du navigateur, c'est que Bootstrap n'est pas inclus correctement.
        if (typeof bootstrap === 'undefined' || !bootstrap.Modal) {
            console.error("Erreur : Bootstrap JavaScript ou ses composants (comme Modal) ne sont pas charg√©s. " +
                          "Assurez-vous d'inclure les scripts Bootstrap 5 (par exemple, bundle.min.js) AVANT votre script.");
            // Arr√™te l'ex√©cution du script pour √©viter d'autres erreurs si Bootstrap est manquant
            return; 
        }

        /**
         * Affiche une alerte dynamique en haut de la page.
         * @param {string} message - Le message √† afficher.
         * @param {string} type - Le type d'alerte (par exemple, 'info', 'success', 'warning', 'danger').
         */
        function showAlert(message, type = 'info') {
            const alertHtml = `
                <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            `;
            // Vider le conteneur avant d'ajouter la nouvelle alerte pour √©viter l'accumulation
            // Si vous voulez que les alertes s'empilent, vous pouvez utiliser `insertAdjacentHTML('afterbegin', alertHtml)`
            dynamicAlertContainer.innerHTML = ''; 
            dynamicAlertContainer.insertAdjacentHTML('beforeend', alertHtml);

            // Masquer l'alerte automatiquement apr√®s 5 secondes
            setTimeout(() => {
                const alertElement = dynamicAlertContainer.querySelector('.alert');
                if (alertElement) {
                    // Obtient l'instance de l'alerte Bootstrap ou en cr√©e une nouvelle pour pouvoir la fermer.
                    const bsAlert = bootstrap.Alert.getInstance(alertElement) || new bootstrap.Alert(alertElement);
                    bsAlert.close();
                }
            }, 5000); // 5000 millisecondes = 5 secondes
        }

        // √âv√©nement d√©clench√© lorsque la modale des d√©tails du film est sur le point d'√™tre affich√©e.
        filmDetailsModal.addEventListener('show.bs.modal', function (event) {
            const button = event.relatedTarget; // Le bouton HTML qui a d√©clench√© l'ouverture de la modale.

            // R√©cup√®re toutes les donn√©es du film depuis les attributs 'data-*' du bouton.
            const filmId = button.getAttribute('data-film-id'); // ID du film (ajout√© pour la route /watch et /add_to_list)
            const title = button.getAttribute('data-title');
            const genre = button.getAttribute('data-genre');
            const description = button.getAttribute('data-description');
            const rating = button.getAttribute('data-rating');
            const image = button.getAttribute('data-image');
            const videoUrl = button.getAttribute('data-video-url'); // URL de la vid√©o (ajout√© pour la lecture)

            // S√©lectionne les √©l√©ments HTML √† l'int√©rieur de la modale pour y injecter les donn√©es.
            const modalTitle = filmDetailsModal.querySelector('#modalFilmTitle');
            const modalGenre = filmDetailsModal.querySelector('#modalFilmGenre');
            const modalDescription = filmDetailsModal.querySelector('#modalFilmDescription');
            const modalRating = filmDetailsModal.querySelector('#modalFilmRating');
            const modalImage = filmDetailsModal.querySelector('#modalFilmImage');
            const playFilmBtn = filmDetailsModal.querySelector('#playFilmBtn');
            const addToListBtn = filmDetailsModal.querySelector('#addToListBtn');

            // Met √† jour le contenu textuel et les attributs de la modale avec les donn√©es du film.
            modalTitle.textContent = title || 'Titre Inconnu';
            modalGenre.textContent = genre || 'N/A';
            modalDescription.textContent = description || 'Pas de description disponible.';
            modalRating.innerHTML = `<i class="bi bi-star-fill"></i> ${rating || 'N/A'}`; // Ajoute l'ic√¥ne √©toile.
            modalImage.src = image || 'https://via.placeholder.com/300x450?text=No+Image'; // Image par d√©faut si manquante.
            modalImage.alt = title || 'Image du film';

            // Stocke les donn√©es compl√®tes du film directement sur les boutons "Regarder" et "Ajouter √† ma liste".
            // Cela permet d'acc√©der facilement √† ces donn√©es quand les boutons sont cliqu√©s.
            playFilmBtn.dataset.filmId = filmId;
            playFilmBtn.dataset.videoUrl = videoUrl;
            playFilmBtn.dataset.title = title; // Utile pour les messages d'alerte

            addToListBtn.dataset.filmId = filmId;
            addToListBtn.dataset.title = title;
            addToListBtn.dataset.genre = genre;
            addToListBtn.dataset.description = description;
            addToListBtn.dataset.rating = rating;
            addToListBtn.dataset.image = image;
            addToListBtn.dataset.videoUrl = videoUrl; // Tr√®s important : s'assurer que l'URL vid√©o est transmise.

            // Affiche ou masque le bouton "Regarder" en fonction de la pr√©sence d'une URL vid√©o valide.
            // La comparaison 'None' est importante car Jinja peut renvoyer la cha√Æne 'None' pour une valeur Python None.
            if (videoUrl && videoUrl !== 'None' && videoUrl.trim() !== '') {
                playFilmBtn.classList.remove('d-none'); // Retire la classe qui masque le bouton.
            } else {
                playFilmBtn.classList.add('d-none'); // Ajoute la classe pour masquer le bouton.
            }
        });

        // Gestionnaire d'√©v√©nements pour le bouton "Regarder" dans la modale.
        document.getElementById('playFilmBtn').addEventListener('click', function() {
            const filmId = this.dataset.filmId;
            const filmTitle = this.dataset.title; // Pour le message d'alerte
            const videoUrl = this.dataset.videoUrl;

            // Ferme la modale de d√©tails avant de rediriger.
            const modalInstance = bootstrap.Modal.getInstance(filmDetailsModal);
            if (modalInstance) {
                modalInstance.hide();
            }

            // V√©rifie si l'ID du film et l'URL vid√©o sont disponibles.
            if (filmId && videoUrl && videoUrl !== 'None' && videoUrl.trim() !== '') {
                // Redirige l'utilisateur vers la page de lecture du film.
                // {{ url_for('api_routes.watch_film', film_id=0) }} est un placeholder Jinja.
                // .replace('0', filmId) ins√®re l'ID r√©el du film dans l'URL.
                window.location.href = `{{ url_for('api_routes.watch_film', film_id=0) }}`.replace('0', filmId);
            } else {
                showAlert(`D√©sol√©, impossible de lancer "${filmTitle}". URL vid√©o manquante ou invalide.`, 'danger');
            }
        });

        // Gestionnaire d'√©v√©nements pour le bouton "Ajouter √† ma liste" dans la modale.
        document.getElementById('addToListBtn').addEventListener('click', async function() {
            // Collecte toutes les donn√©es du film √† envoyer au backend.
            const filmData = {
                film_id: this.dataset.filmId, // Utilise l'ID du film, c'est plus robuste que le titre seul.
                title: this.dataset.title,
                genre: this.dataset.genre,
                description: this.dataset.description,
                // Convertit l'√©valuation en nombre flottant. Si invalide, utilise `null`.
                rating: parseFloat(this.dataset.rating) || null, 
                image: this.dataset.image,
                video_url: this.dataset.videoUrl // Inclut l'URL vid√©o pour le backend.
            };

            // Nettoie l'objet filmData en supprimant les propri√©t√©s qui sont `undefined`, `null`, `'None'` ou vides.
            for (const key in filmData) {
                if (filmData[key] === 'undefined' || filmData[key] === null || filmData[key] === 'None' || (typeof filmData[key] === 'string' && filmData[key].trim() === '')) {
                    delete filmData[key];
                }
            }

            try {
                // Envoie une requ√™te POST asynchrone au backend Flask pour ajouter le film.
                const response = await fetch('{{ url_for('api_routes.add_to_list') }}', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json', // Indique que nous envoyons du JSON.
                    },
                    body: JSON.stringify(filmData), // Convertit l'objet JavaScript en cha√Æne JSON.
                });

                const result = await response.json(); // Parse la r√©ponse JSON du serveur.

                // V√©rifie si la requ√™te HTTP a r√©ussi (statut 2xx).
                if (response.ok) { 
                    showAlert(result.message, result.status); // Affiche le message du serveur.
                } else { 
                    // Si le serveur a renvoy√© un statut d'erreur (par exemple 400, 401, 500).
                    showAlert(result.message || 'Erreur lors de l\'ajout √† la liste.', 'danger');
                }
            } catch (error) {
                // G√®re les erreurs r√©seau (par exemple, serveur injoignable).
                console.error('Erreur lors de l\'ajout √† la liste:', error);
                showAlert('Une erreur r√©seau est survenue. Veuillez r√©essayer.', 'danger');
            } finally {
                // Ferme toujours la modale apr√®s que l'action soit termin√©e, qu'elle ait r√©ussi ou √©chou√©.
                const modalInstance = bootstrap.Modal.getInstance(filmDetailsModal);
                if (modalInstance) {
                    modalInstance.hide();
                }
            }
        });
    });
</script>
{% endblock %}